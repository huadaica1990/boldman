var fileCurrent,preloadTemplate='<div class="pre-load"><div class="flex-center"><div class="loader"></div></div></div>',errorTemplate='<div class="alert-test"><div class="alert-title ecs-icon-times-circle" ></div > ERROR_MSG</div>',cartWishList=!0,cartCountDown=!0,cartCompare=!0;function updateViewCount(e,t){$.ajax({url:t,type:"GET",data:{id:e},beforeSend:function(){},success:function(){},error:function(){}})}function updateRateCount(e,t,r){$.ajax({url:r,type:"GET",data:{id:e,viewname:t},beforeSend:function(){},success:function(e){$("#avg-rating-container-ajax").html(e.viewsrc)},error:function(){}})}function search(e){$.ajax({url:"/aj/Search/PreSearch",type:"GET",data:{keyword:e},beforeSend:function(){},success:function(e){e.Ok?$(".search-result-step2 .search-result-history").html(e.Data.viewsrc):($("#error-modal p").text(e.msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function addRating(e,t){var r=!0,a=$(e),o=$(t).find(".error-lst"),i=$(t).find(".list-image");$(t).validate({focusCleanup:!0,focusInvalid:!1,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(r){var a="<div>"+text1+this.numberOfInvalids()+text2+"</div>";$.each(t,function(){a+='<div class="alert-test"><div class="alert-title ecs-icon-times-circle"></div> '+this.message+$(this.element).data("name")+"</div>"}),o.html(a),r=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?o.show():o.hide(),r=!0},submitHandler:function(e){r=!0,$.ajax({url:$(t).attr("action"),type:"POST",data:$(t).serialize(),beforeSend:function(){Ecsgroup.showLoading(a)},success:function(e){return setTimeout(function(){a.removeClass("load-more-overlay loading")},1e3),Ecsgroup.hideLoading(),e.Ok?(o.hide(),$(t).trigger("reset"),$(".rating-stars a").removeClass("active"),i.html(""),$(t).find('input[name="ListImage"]').val("[]"),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+e.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'})):o.html(errorTemplate.replace("ERROR_MSG",e.Msg)).show(),!1},error:function(e){return Ecsgroup.hideLoading(a),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function loadmorerating(e,t,r){var a=$(e),o=a.parent().find("#currentIndex");$.ajax({url:"/aj/Product/LoadmoreRating",type:"GET",data:{productId:t,page:o.val(),pagesize:r},beforeSend:function(){a.addClass("load-more-overlay loading")},success:function(e){$("html, body").animate({scrollTop:$("#rate .col-loadmore > *").last().offset().top-80},500),a.removeClass("load-more-overlay loading"),o.val(e.CurrentPage+1),$("#rate .col-loadmore").append(e.viewsrc),e.CurrentPage>=e.TotalPageCount&&$("#loadmorecmt").hide()},error:function(e){a.removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function showreply(e,t){$(".formreply").hide(),$(e).find("textarea").val("").focus(),$(e).show(),$(e).find(".formreply").show(),$(e).find("textarea").val("@"+t+": "),$("html, body").animate({scrollTop:$(e).offset().top-190},200)}function addComment(e,t){var r=!0,a=$(e),o=$(t).find(".error-lst"),i=$(t).find(".list-image");$(t).validate({focusCleanup:!0,focusInvalid:!1,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(r){var a="<div>"+text1+this.numberOfInvalids()+text2+"</div>";$.each(t,function(){a+='<div class="alert-test"><div class="alert-title ecs-icon-times-circle"></div> '+this.message+$(this.element).data("name")+"</div>"}),o.html(a),r=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?o.show():o.hide(),r=!0},submitHandler:function(e){r=!0,$.ajax({url:$(t).attr("action"),type:"POST",data:$(t).serialize(),beforeSend:function(){Ecsgroup.showLoading(a)},success:function(e){return setTimeout(function(){a.removeClass("load-more-overlay loading")},1e3),Ecsgroup.hideLoading(),e.Ok?(o.hide(),$(t).trigger("reset"),i.html(""),$(t).find('input[name="ListImage"]').val("[]"),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+e.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'})):o.html(errorTemplate.replace("ERROR_MSG",e.Msg)).show(),!1},error:function(e){return Ecsgroup.hideLoading(a),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function loadmorecomment(e,t,r){var a=$(e),o=a.parent().find("#currentIndex");$.ajax({url:"/aj/News/LoadmoreComment",type:"GET",data:{newsid:t,page:o.val(),pagesize:r},beforeSend:function(){a.addClass("load-more-overlay loading")},success:function(e){$("html, body").animate({scrollTop:$("#comment .col-loadmore > *").last().offset().top-80},500),a.removeClass("load-more-overlay loading"),o.val(e.CurrentPage+1),$("#comment .col-loadmore").append(e.viewsrc),e.CurrentPage>=e.TotalPageCount&&$("#loadmorecmt").hide()},error:function(e){a.removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function removecmtimg(e){var t=$(e).data("target"),r=$(t).find('input[name="ListImage"]').val(),a=$(e).data("src"),o=JSON.parse(r);o=o.filter(function(e){return e!==a}),$(t).find('input[name="ListImage"]').val(JSON.stringify(o)),$(e).parent().remove()}function DeleteFile(e){$.ajax({url:"/aj/Shared/DeleteFile",type:"POST",data:{path:e},beforeSend:function(){Ecsgroup.showLoading()},success:function(){Ecsgroup.hideLoading()},error:function(){Ecsgroup.hideLoading()}})}function UpdateFile(e,t,r){var a=new FormData,o=e._realInput.files;if(o.length>0)for(var i=0;i<o.length;i++){if(o[i].size>5242880)return alert(text3),-1;a.append("HelpSectionImages"+i,o[i])}$.ajax({url:"/aj/Shared/UploadFile?pathStr=/file/"+(t||"banner")+"/",type:"POST",processData:!1,contentType:!1,data:a,beforeSend:function(){Ecsgroup.showLoading()},success:function(t){Ecsgroup.hideLoading(),t.Ok?(e._chipContainer.insertAdjacentHTML("beforeend",r),e._toggleNoFile(),$(e._realvalueInput).val(t.Data[0]),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+t.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'}),fileCurrent=e):($("#error-modal p").text(t.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){Ecsgroup.hideLoading(),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function UpdateImage(e,t,r,a){var o=new FormData,i=e.files;if(i.length>0)for(var n=0;n<i.length;n++){if(i[n].size>5242880)return alert(text3),-1;o.append("HelpSectionImages"+n,i[n])}$(e).val(""),$.ajax({url:"/aj/Shared/UploadImage?pathStr=/img/"+(r||"banner")+"/",type:"POST",processData:!1,contentType:!1,data:o,beforeSend:function(){Ecsgroup.showLoading()},success:function(e){if(Ecsgroup.hideLoading(),e.Ok){var r='<div class="img-item br-sm"><a href="javascript:" class="img-cmt-js" data-target="'+a+'" data-src="'+e.Data+'" onclick="removecmtimg(this)"><i class="demo-icon cus-cancel"></i></a><img src="'+e.Data+'" alt="" width="150" height="100" loading="lazy"></div>';$(a).find(".list-image").append(r);var o=new Array;$(a).find(".list-image .img-item").each(function(){var e=$(this).find("img").attr("src");o.push(e)}),$(a).find('input[name="'+t+'"]').val(JSON.stringify(o)),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+e.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'})}else $("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")},error:function(e){$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function addToCart(e,t,r){var a=new Array;null!=window.localStorage.getItem("cartlist")&&(a=JSON.parse(window.localStorage.getItem("cartlist")));var o=$(e),i=o.data("id"),n=o.data("current-text"),s=o.data("loading-text"),l=o.data("loading-dot"),d=o.data("producttype"),c=o.parent().find(t).val();o.addClass("load-more-overlay loading").html(l);var u=a.find((e,t)=>e.id===i);if(null!=u)u.quantity+=parseInt(c);else{var p={id:i,quantity:parseInt(c),type:d,displayorder:a.length+1};a.push(p)}window.localStorage.setItem("cartlist",JSON.stringify(a)),null!=r?window.location.href=r:(updateCart(),setTimeout(function(){o.html(s).css("pointer-events","none").removeClass("load-more-overlay loading"),showCartInfo()},1e3),setTimeout(function(){o.html(n).css("pointer-events","auto")},2e3))}function addToCartList(e,t,r){var a=new Array;null!=window.localStorage.getItem("cartlist")&&(a=JSON.parse(window.localStorage.getItem("cartlist")));var o=$(e),i=o.data("current-text"),n=o.data("loading-text"),s=o.data("loading-dot"),l=JSON.parse($(t).val());o.addClass("load-more-overlay loading").html(s),l.forEach(function(e){var t=a.find((t,r)=>t.id===e.ProductId);if(null!=t)t.quantity+=parseInt(e.Quantity);else{var r={id:e.ProductId,quantity:parseInt(e.Quantity),type:e.Type,displayorder:a.length+1};a.push(r)}}),window.localStorage.setItem("cartlist",JSON.stringify(a)),null!=r?window.location.href=r:(updateCart(),setTimeout(function(){o.html(n).css("pointer-events","none").removeClass("load-more-overlay loading")},1e3),setTimeout(function(){o.html(i).css("pointer-events","auto")},2e3))}function updateCart(){var e=new Array;null!=window.localStorage.getItem("cartlist")&&(e=JSON.parse(window.localStorage.getItem("cartlist"))),$(".cart-count-txt").text(e.length)}function showCartInfo(){var e='<div class="cart-info show"><p class="ishow"><i class="demo-icon cus-attention-circled"></i> '+text5+'</p><a class="ishow btn" href="'+Ecsgroup.cartLink+'" title= "'+text5+'">'+text6+'</a><a class="close ecs-icon-times-solid cart-info-close" href="javascript:"></a></div>';$(".js-cart-info").html(e),$("body").append('<div class="cart-info-backdrop cart-info-close show"></div>'),Ecsgroup.$body.on("click",".cart-info-close",function(e){$(".cart-info-backdrop").remove(),$(".cart-info").remove()})}function initCompare(e){var t=new Array;null!=window.localStorage.getItem("comparelist")&&(t=JSON.parse(window.localStorage.getItem("comparelist"))),$(e+" .btn-compare").addClass("disabled"),console.log("initCompare loading..."),t.length>0&&$(e+" .btn-compare").length>0?t.forEach(function(t){$(e+' .btn-compare[data-id="'+t.id+'"]').removeClass("ecs-icon-compare").addClass("added ecs-icon-check-solid").attr("href",Ecsgroup.linkCompare)}):$(e+" .btn-compare").removeClass("added ecs-icon-check-solid").addClass("ecs-icon-compare").attr("href","javascript:"),console.log("initCompare complete"),$(e+" .btn-compare").removeClass("disabled")}function updateWishLst(e,t){var r=new Array;null!=window.localStorage.getItem("wishlist")&&(r=JSON.parse(window.localStorage.getItem("wishlist")));var a=$(e);null==r.find((e,r)=>e===t)&&r.push(t),$.ajax({url:"/aj/Account/UpdateWishList",type:"POST",data:{listId:JSON.stringify(r)},beforeSend:function(){a.addClass("load-more-overlay loading")},success:function(e){e.Ok?(a.removeClass("load-more-overlay loading"),$('body .btn-wishlist[data-id="'+t+'"]').removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+e.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'}),window.localStorage.setItem("wishlist",JSON.stringify(r))):(a.removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){a.removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function initHeart(e){console.log("initHeart loading...");var t=new Array;null!=window.localStorage.getItem("wishlist")&&(t=JSON.parse(window.localStorage.getItem("wishlist"))),$(e+" .btn-wishlist").addClass("disabled"),$(e+" .btn-quickview").addClass("disabled"),t.length>0&&$(e+" .btn-wishlist").length>0?(t.forEach(function(t){$(e+' .btn-wishlist[data-id="'+t+'"]').removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList)}),console.log("initHeart complete")):$.ajax({url:"/aj/Account/GetHeartStatus",type:"POST",beforeSend:function(){},success:function(t){t.Data&&(t.Data.forEach(function(t){$(e+' .btn-wishlist[data-id="'+t+'"]').removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList)}),window.localStorage.setItem("wishlist",JSON.stringify(t.Data)),console.log("initHeart complete"))},error:function(){console.log("initHeart error")}}),$(e+" .btn-wishlist").removeClass("disabled"),$(e+" .btn-quickview").removeClass("disabled")}function selectSku(e,t){let r=$(e),a=r.data("container"),o=parseInt(r.data("attid")),i=parseInt(r.data("attvalid")),n=r.data("productid"),s=$(a+" .btn-wishlist.added").length,l=$(a+" .btn-compare.added").length,d=JSON.parse($(a+" .attrlist-singlesku").val()),c="/aj/Shared/SelectVerProduct?id="+n+"&ver=";urlprodut=r.data("url"),d.forEach(function(e,t){e.ProductAttributeId===o?(c+=(0==t?"":"v")+o+"-"+i,urlprodut+=(0==t?"":"v")+o+"-"+i):(c+=(0==t?"":"v")+e.ProductAttributeId+"-"+e.ProductAttributeValueId,urlprodut+=(0==t?"":"v")+e.ProductAttributeId+"-"+e.ProductAttributeValueId)}),cartCountDown&&$(a+" .product-countdown").countdown("destroy"),$.ajax({url:c,type:"GET",data:{viewname:t},beforeSend:function(){"#product-popup-ajax"!=a?$(a).addClass("preload-container").append(preloadTemplate):$(a).addClass("shimmer-container")},success:function(e){"#product-popup-ajax"!=a?$(a).removeClass("preload-container").remove(".pre-load"):$(a).removeClass("shimmer-container"),e.Ok?($(a).html(e.Data.viewsrc).find(".product-url").attr("href",urlprodut),setTimeout(function(){Ecsgroup.productSingle(a),cartCountDown&&Ecsgroup.countDown(a+" .product-countdown"),cartWishList&&$(a+" .btn-wishlist").removeClass("disabled"),cartCompare&&$(a+" .btn-compare").removeClass("disabled"),s>0&&$(a+" .btn-wishlist").removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList),l>0&&$(a+" .btn-compare").removeClass("ecs-icon-compare").addClass("added ecs-icon-check-solid").attr("href",Ecsgroup.linkCompare)},500),"#product-popup-ajax"!=a&&$("html, body").animate({scrollTop:$(a).offset().top-80},500)):($("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){"#product-popup-ajax"!=a?$(a).removeClass("preload-container").remove(".pre-load"):$(a).removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function selectSkuDetail(e){var t=$(e),r=$("#product-info .btn-wishlist.added").length,a=$("#product-info .btn-compare.added").length,o=t.data("url"),i=parseInt(t.data("id")),n=parseInt(t.data("valid")),s=JSON.parse($("#attrlisthd").val()),l=window.location.href.split("?")[0]+"?ver=",d="/aj/product/selectverproduct?ver=";s.forEach(function(e,t){e.ProductAttributeId===i?(d+=(0==t?"":"v")+i+"-"+n,l+=(0==t?"":"v")+i+"-"+n):(d+=(0==t?"":"v")+e.ProductAttributeId+"-"+e.ProductAttributeValueId,l+=(0==t?"":"v")+e.ProductAttributeId+"-"+e.ProductAttributeValueId)}),$("#product-info").css("height",$("#product-info").height()+"px"),cartCountDown&&$("#product-info .product-countdown").countdown("destroy"),$.ajax({url:d,type:"POST",data:{url:o},beforeSend:function(){$("#product-info").addClass("shimmer-container")},success:function(e){$("#product-info").removeClass("shimmer-container"),e.Ok?($("#product-info").html(e.Data.viewsrc).css("height","auto"),$(".url-ajax").each(function(){$(this).data("url")?$(this).attr("href",$(this).data("url")+window.location.href):$(this).attr("href",window.location.href)}),window.history.pushState({state:l,rand:Math.random()},document.title,l),setTimeout(function(){cartCountDown&&Ecsgroup.countDown("#product-info .product-countdown"),cartWishList&&$("#product-info .btn-wishlist").removeClass("disabled"),cartCompare&&$("#product-info .btn-compare").removeClass("disabled"),r>0&&$("#product-info .btn-wishlist").removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList),a>0&&$("#product-info .btn-compare").removeClass("ecs-icon-compare").addClass("added ecs-icon-check-solid").attr("href",Ecsgroup.linkCompare)},1e3),$("html, body").animate({scrollTop:$("#product-info").offset().top-80},500),Ecsgroup.stickyContent(".product-sticky-content",Ecsgroup.stickyProductOptions),Ecsgroup.productSingle("#product-info .product-single"),Ecsgroup.initProductSinglePage.init(),Ecsgroup.slider("#product-info .swiper-container"),Ecsgroup.shop.init()):($("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){$("#product-info").removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function selectThumbSku(e,t,r){let a=e,o="";$.ajax({url:"/aj/Shared/SelectSkuById",type:"GET",data:{skuid:parseInt(t)},beforeSend:function(){a.addClass("shimmer-container")},success:function(e){a.removeClass("shimmer-container"),e.Ok?(o=0!=e.Data.listedprice?'<ins class="new-price price-promoprice">'+e.Data.price.toLocaleString("vi-VN",{style:"currency",currency:"VND"})+'</ins><label class="product-label label-discount"><span>-'+e.Data.percent+"%</span></label>":'<ins class="new-price">'+e.Data.price.toLocaleString("vi-VN",{style:"currency",currency:"VND"})+"</ins>",a.find('input[type="checkbox"]').length>0&&(a.find('input[type="checkbox"]').attr({"data-price":e.Data.price,"data-promprice":e.Data.listedprice,value:t}).prop("checked",!1),Ecsgroup.initProductSinglePage.recommendItems()),a.find(".product-url").attr("href",r+e.Data.url),a.find(".btn-quickview ").attr("data-url",e.Data.url),a.find(".product-price").html(o)):($("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){a.removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function openProductPopup(e){var t=$(e),r="#product-popup-ajax",a=t.data("id"),o=t.parent().find(".btn-wishlist.added").length,i=t.parent().find(".btn-compare.added").length,n="/aj/Shared/SelectVerProduct?id="+a+"&ver="+t.data("url");$.ajax({url:n,type:"GET",data:{viewname:"_ItemProductPopup"},beforeSend:function(){},success:function(e){e.Ok?($(r).html(e.Data.viewsrc),Ecsgroup.popup([{src:"#product-popup",type:"inline"}],{on:{done:()=>{Ecsgroup.productSingle(r),setTimeout(function(){cartCountDown&&Ecsgroup.countDown(r+" .product-countdown"),t.removeClass("load-more-overlay loading"),cartWishList&&$(r+" .btn-wishlist").removeClass("disabled"),cartCompare&&$(r+" .btn-compare").removeClass("disabled"),o>0&&$(r+" .btn-wishlist").removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList),i>0&&$(r+" .btn-compare").removeClass("ecs-icon-compare").addClass("added ecs-icon-check-solid").attr("href",Ecsgroup.linkCompare),$(r).removeClass("shimmer-container")},500)},closing:()=>{cartCountDown&&$(r+" .product-countdown").countdown("destroy")}}},"quickview")):($("#error-modal p").text(e.msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function refreshFilterNews(){var e=$("#filterform");e.find('input[name="sort"]').val($("#sortdropdown").val()),e.find('input[name="page"]').val(1),getFilterResultNews()}function loadmoreFilterNews(){var e=$("#filterform"),t=parseInt(e.find('input[name="page"]').val())+1;e.find('input[name="page"]').val(t),e.find('input[name="sort"]').val($("#sortdropdown").val()),getFilterResultNews("loadmore")}function getFilterResultNews(e){var t=$("#filterform"),r=["page","sort"];if("loadmore"===e){var a=$("#list-filter-loadmore > *").last().offset().top;$.ajax({url:t.attr("action"),type:"GET",data:t.serialize()+"&type=loadmore",beforeSend:function(){$("#loadmore").addClass("load-more-overlay loading"),$("#list-filter-loadmore").addClass("shimmer-container")},success:function(e){$("html, body").animate({scrollTop:a+100},500),$("#list-filter-loadmore").append(e.viewsrc).removeClass("shimmer-container"),totalitem="1-"+$("#list-filter-loadmore > *").length+"/"+e.TotalItemCount,$(".readmore-count").text("("+e.itemremaining+")"),$(".totalitem").text(totalitem),t.find('input[name="page"]').val(e.CurrentPage),e.CurrentPage>=e.TotalPageCount&&$("#loadmore").hide(),updateState(r),$("#loadmore").removeClass("load-more-overlay loading")},error:function(e){$("#list-filter-loadmore").removeClass("shimmer-container"),$("#loadmore").removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}else $.ajax({url:t.attr("action"),type:"GET",data:t.serialize(),beforeSend:function(){$("#list-filter").addClass("shimmer-container")},success:function(e){$("#list-filter").html(e).removeClass("shimmer-container"),$(".totalitem").text(totalitem),updateState(r)},error:function(e){$("#list-filter").removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function refreshFilterProduct(){var e=$("#filterform"),t=[];if($('#filter input[name="attr"]:checked').each(function(){var e=$(this).val().split("-");if(2==e.length){var r=t.find(function(t){return t.attid==e[0]});r?r.valid.push(e[1]):t.push({attid:e[0],valid:[e[1]]})}}),e.find('input[name="pp"]').val(""),t.length>0){for(var r="",a=0;a<t.length;a++)0!=a&&(r+="v"),r+=t[a].attid+"-"+t[a].valid.join(",");e.find('input[name="pp"]').val(r)}var o=[];$('#filter input[name="brand"]:checked').each(function(){o.push($(this).val())}),e.find('input[name="bp"]').val(""),o.length>0&&e.find('input[name="bp"]').val(o.join(","));var i=[];$('#filter input[name="price"]:checked').each(function(){i.push($(this).val())}),e.find('input[name="pr"]').val(""),i.length>0&&e.find('input[name="pr"]').val(i.join(",")),e.find('input[name="sort"]').val($("#sortdropdown").val()),e.find('input[name="page"]').val(1),getFilterResultProduct()}function loadmoreFilterProduct(){var e=$("#filterform"),t=parseInt(e.find('input[name="page"]').val())+1;e.find('input[name="page"]').val(t),e.find('input[name="sort"]').val($("#sortdropdown").val()),getFilterResultProduct("loadmore")}function getFilterResultProduct(e){var t=$("#filterform"),r=["page","pp","bp","pr","sort"];if(cartCountDown&&$("#list-filter .product-countdown").countdown("destroy"),"loadmore"===e){var a=$("#list-filter-loadmore > *").last().offset().top;$.ajax({url:t.attr("action"),type:"GET",data:t.serialize()+"&type=loadmore",beforeSend:function(){$("#loadmore").addClass("load-more-overlay loading"),$("#list-filter-loadmore").addClass("shimmer-container")},success:function(e){$("html, body").animate({scrollTop:a},500),$("#list-filter-loadmore").append(e.viewsrc).removeClass("shimmer-container"),$("#list-filter-loadmore .lazyload-bg").each(function(){$(this).css("background-image","url("+$(this).data("bg")+")").removeClass("lazyload-bg").addClass("ls-is-cached lazyloaded")}),setTimeout(function(){cartCountDown&&Ecsgroup.countDown("#list-filter .product-countdown"),cartWishList&&initHeart("#list-filter")},1e3),totalitem="1-"+$("#list-filter-loadmore > *").length+"/"+e.TotalItemCount,$(".readmore-count").text("("+e.itemremaining+")"),$(".totalitem").text(totalitem),t.find('input[name="page"]').val(e.CurrentPage),e.CurrentPage>=e.TotalPageCount&&$("#loadmore").hide(),updateState(r),$("#loadmore").removeClass("load-more-overlay loading")},error:function(e){$("#list-filter-loadmore").removeClass("shimmer-container"),$("#loadmore").removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}else $.ajax({url:t.attr("action"),type:"GET",data:t.serialize(),beforeSend:function(){$("#list-filter").addClass("shimmer-container"),Ecsgroup.showLoading()},success:function(e){$("html, body").animate({scrollTop:$("#productcat").offset().top-100},500),$("#list-filter").html(e).removeClass("shimmer-container"),$("#list-filter .lazyload-bg").each(function(){$(this).css("background-image","url("+$(this).data("bg")+")").removeClass("lazyload-bg").addClass("ls-is-cached lazyloaded")}),setTimeout(function(){cartCountDown&&Ecsgroup.countDown("#list-filter .product-countdown"),cartWishList&&initHeart("#list-filter"),cartCompare&&initCompare("#list-filter")},1e3),$(".totalitem").text(totalitem),Ecsgroup.hideLoading(),updateState(r)},error:function(e){$("#list-filter").removeClass("shimmer-container"),Ecsgroup.hideLoading(),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function getLocation(){navigator.geolocation?(navigator.geolocation.getCurrentPosition(showPosition),$("#btn-near-location").addClass("active")):($("#error-modal p").text(text4),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))}function showPosition(e){resetFilterStore();var t=$("#filterform"),r=$("#search-store-from"),a=e.coords.latitude,o=e.coords.longitude;r.find('input[name="lat"]').val(a),r.find('input[name="log"]').val(o),t.find("input[name='lat']").val(a),t.find("input[name='log']").val(o),$(".select-district li").length>1?$('.select-district li[data-value="0"]').trigger("click"):refreshFilterStore()}function refreshDistrictList(){var e=$("#filter input[name='province']:checked").val();$.ajax({url:"/aj/store/RefreshDistrictList",type:"GET",data:{provinceid:e},beforeSend:function(){Ecsgroup.showLoading()},success:function(e){Ecsgroup.hideLoading(),$(".select-district-js").html(e)},error:function(e){Ecsgroup.hideLoading(),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function resetFilterStore(){var e=$("#filterform"),t=$("#search-store-from"),r=e.find('input[name="pagesize"]').val();$("#filter #select-district").val(null),e.find("input").val(null),t.find("input").val(null),t.find('input[name="sort"]').val(0),e.find('input[name="sort"]').val(0),e.find('input[name="pagesize"]').val(r),e.find('input[name="page"]').val(1)}function refreshFilterStore(){var e=$("#filterform"),t=$("#search-store-from");e.find('input[name="sort"]').val($("#sortdropdown").val());var r=[];$('#filter input[name="province"]:checked').each(function(){r.push($(this).val())}),e.find('input[name="province"]').val(""),t.find('input[name="province"]').val(""),r.length>0&&(e.find('input[name="province"]').val(r),t.find('input[name="province"]').val(r));var a=[];a.push($("#filter #select-district").val()),e.find('input[name="district"]').val(""),t.find('input[name="district"]').val(""),a.length>0&&(e.find('input[name="district"]').val(a),t.find('input[name="district"]').val(a)),e.find('input[name="page"]').val(1),getFilterResultStore()}function getFilterResultStore(e){var t=$("#filterform"),r=["storekey","province","district","lat","log","page","sort"];if("loadmore"===e){var a=$("#list-filter-loadmore > *").last().offset().top;$.ajax({url:t.attr("action"),type:"GET",data:t.serialize()+"&type=loadmore",beforeSend:function(){$("#loadmore").addClass("load-more-overlay loading"),$("#list-filter-loadmore").addClass("shimmer-container")},success:function(e){$("html, body").animate({scrollTop:a+100},500),$("#list-filter-loadmore").append(e.viewsrc).removeClass("shimmer-container"),totalitem="1-"+$("#list-filter-loadmore > *").length+"/"+e.TotalItemCount,$(".readmore-count").text("("+e.itemremaining+")"),$(".totalitem").text(totalitem),t.find('input[name="page"]').val(e.CurrentPage),e.CurrentPage>=e.TotalPageCount&&$("#loadmore").hide(),updateState(r),$("#loadmore").removeClass("load-more-overlay loading")},error:function(e){$("#list-filter-loadmore").removeClass("shimmer-container"),$("#loadmore").removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}else $.ajax({url:t.attr("action"),type:"GET",data:t.serialize(),beforeSend:function(){$("#list-filter").addClass("shimmer-container")},success:function(e){$("#list-filter").html(e).removeClass("shimmer-container"),$(".totalitem").text(totalitem),updateState(r)},error:function(e){$("#list-filter").removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function loadmoreSrcoll(){var e=$("#filterform"),t=parseInt(e.find('input[name="page"]').val())+1,r=$("#list-filter-loadmore"),a=["keysearch","page","sort"];e.find('input[name="page"]').val(t),$.ajax({url:e.attr("action"),type:"GET",data:e.serialize()+"&type=loadmore",beforeSend:function(){r.attr("data-load-state","loading"),r.next().hasClass("load-more-overlay")?r.next().addClass("loading"):$('<div class="load-more-overlay loading"></div>').insertAfter(r)},success:function(e){e.CurrentPage>e.TotalPageCount?(r.next().removeClass("loading"),window.removeEventListener("scroll",loadmoreSrcoll,{passive:!0})):(r.attr("data-load-count",e.CurrentPage),setTimeout(function(){r.next().removeClass("loading"),r.append(e.viewsrc),initHeart("#list-filter-loadmore"),initCompare("#list-filter-loadmore"),r.data("load-state","loaded")},500),updateState(a))},error:function(e){$("#error-modal p").text(e.Msg),Ecsgroup.popup({items:{src:"#error-modal"}},"error")}})}function updateState(e){for(var t=$("#filterform").serializeArray(),r="",a=window.location.href.split("?")[0],o=document.title,i=0;i<t.length;i++){var n=t[i];void 0!==n.value&&""!==n.value&&(e.includes(n.name)&&(r+="&"+n.name+"="+n.value))}r=""===(r=r.replace(/(^&)|(&$)/g,""))?a:a+"?"+r,window.history.pushState({state:r,rand:Math.random()},o,r)}function ajaxProduct(e,t,r,a){let o=$(e),i=o.parent(),n=t.split("|"),s=n[0],l=n[1];switch(cartCountDown&&$(a+" .product-countdown").countdown("destroy"),s){case"productgroup":$.ajax({url:"/aj/Shared/ProductGroupAjax",type:"GET",data:{id:l,viewname:r},beforeSend:function(){i.scrollLeft(o.offset().left-15),o.addClass("active load-more-overlay loading").siblings().removeClass("active"),$(a).addClass("shimmer-container")},success:function(e){e.Ok?(o.removeClass("load-more-overlay loading"),$(a).html(e.Data.viewsrc).removeClass("shimmer-container"),$(a+" .lazyload-bg").each(function(){$(this).css("background-image","url("+$(this).data("bg")+")").removeClass("lazyload-bg").addClass("ls-is-cached lazyloaded")}),setTimeout(function(){cartCountDown&&Ecsgroup.countDown(a+" .product-countdown"),cartWishList&&initHeart(a),cartCompare&&initCompare(a)},1e3)):(o.removeClass("load-more-overlay loading"),$(a).removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){o.removeClass("load-more-overlay loading"),$(a).removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}}function validateForm(e,t){var r=!0,a=$(t).find(".error-lst");$(t).validate({focusCleanup:!0,focusInvalid:!1,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(r){var o="<div>"+text1+this.numberOfInvalids()+text2+"</div>";$.each(t,function(){o+='<div class="alert-test"><div class="alert-title ecs-icon-times-circle"></div> '+this.message+$(this.element).data("name")+"</div>"}),a.html(o),r=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?a.show():a.hide(),r=!0},submitHandler:function(o){r=!0;var i=$(t).find('*[name="Note"]').val(),n=[];$(t).find(".get-value").each(function(e){var t=$(this).attr("name");if(!["name","email","phonenumber","body","file"].includes(t)){var r=$(this).data("type"),a=$(this).data("name"),o=$(this).val(),i=$(this).prop("name");7!==r&&8!==r||!1===$(this).is(":checked")&&(o=null),n.push({Name:a,Value:o,Tag:r,Code:i})}}),$.ajax({url:$(t).attr("action"),dataType:"json",method:"POST",data:$(t).serialize()+"&extentionfield="+JSON.stringify(n),beforeSend:function(){$(e).addClass("load-more-overlay loading")},success:function(r){return $(e).removeClass("load-more-overlay loading"),r.Ok?(sendMail(r.Data.id,"/aj/Shared/SendEmail"),a.hide(),$("#success-modal p").text(i),Ecsgroup.popup([{src:"#success-modal",type:"inline"}],{},"error"),$(t).trigger("reset"),void 0!==fileCurrent&&fileCurrent._removeChips()):a.html(errorTemplate.replace("ERROR_MSG",r.Msg)).show(),!1},error:function(t){return $(e).removeClass("load-more-overlay loading"),$("#error-modal p").text(t.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function validateFormMini(e,t){$(t).validate({focusInvalid:!0,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(submitted){var r=text1+this.numberOfInvalids()+text2+"<br>";$.each(t,function(){r+=this.message+$(this.element).data("name")+"<br>"}),$("#error-modal p").html(r),submitted=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"):Fancybox.getInstance().close(),submitted=!0},submitHandler:function(r){$.ajax({url:$(t).attr("action"),dataType:"json",method:"POST",data:$(t).serialize()+"&extentionfield=",beforeSend:function(){$(e).addClass("load-more-overlay loading")},success:function(r){return $(e).removeClass("load-more-overlay loading"),r.Ok?(sendMail(r.Data.id,"/aj/Shared/SendEmail"),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+r.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'}),$(t).trigger("reset"),Fancybox.getInstance().close()):($("#error-modal p").text(r.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")),!1},error:function(t){return $(e).removeClass("load-more-overlay loading"),$("#error-modal p").text(t.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function sendMail(e,t){$.ajax({url:t,type:"GET",data:{id:e},beforeSend:function(){},success:function(){},error:function(){}})}function validateFormApi(e,t,r){var a=!0,o=$(t).find(".error-lst");$(t).validate({focusCleanup:!0,focusInvalid:!1,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(a){var r="<div>"+text1+this.numberOfInvalids()+text2+"</div>";$.each(t,function(){r+='<div class="alert-test"><div class="alert-title ecs-icon-times-circle"></div> '+this.message+$(this.element).data("name")+"</div>"}),o.html(r),a=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?o.show():o.hide(),a=!0},submitHandler:function(r){a=!0;var i=$(t).find('*[name="Note"]').val(),n=[];$(t).find(".get-value").each(function(e){var t=$(this).attr("name");if(!["name","email","phonenumber","body","file"].includes(t)){var r=$(this).data("type"),a=$(this).data("name"),o=$(this).val(),i=$(this).prop("name");7!==r&&8!==r||!1===$(this).is(":checked")&&(o=null),n.push({Name:a,Value:o,Tag:r,Code:i})}}),$.ajax({url:"https://boldman.vn/aj/StaticPage/ContactApi",dataType:"json",method:"POST",data:$(t).serialize()+"&extentionfield="+JSON.stringify(n),beforeSend:function(){$(e).addClass("load-more-overlay loading")},success:function(r){return $(e).removeClass("load-more-overlay loading"),r.Ok?(sendMailApi(r.Data.id,"https://boldman.vn/aj/staticpage/SendEmailApi","tronghuy2208@gmail.com"),o.hide(),$("#success-modal p").text(i),Ecsgroup.popup([{src:"#success-modal",type:"inline"}],{},"error"),$(t).trigger("reset"),void 0!==fileCurrent&&fileCurrent._removeChips()):o.html(errorTemplate.replace("ERROR_MSG",r.Msg)).show(),!1},error:function(t){return $(e).removeClass("load-more-overlay loading"),$("#error-modal p").text(t.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function sendMailApi(e,t,r){$.ajax({url:t,type:"GET",data:{id:e,emailTo:r},beforeSend:function(){},success:function(){},error:function(){}})}updateCart(),setTimeout(function(){cartWishList&&initHeart("body"),cartCompare&&initCompare("body")},3e3),$.extend($.validator.messages,{required:validate1,remote:validate2,email:validate3,url:validate4,date:validate5,dateISO:validate6,number:validate7,digits:validate8,creditcard:validate9,equalTo:validate10,accept:validate11,maxlength:$.validator.format(validate12),minlength:$.validator.format(validate13),rangelength:$.validator.format(validate14),range:$.validator.format(validate15),max:$.validator.format(validate16),min:$.validator.format(validate17)});